var articlesApp=function(){function e(e,t,n){let a=localStorage.getItem("token"),r=document.getElementById(e);r.addEventListener("submit",(function(e){e.preventDefault();let i=new FormData(r),l=`${window.location.origin}${t}`,d=new XMLHttpRequest;d.open(n,l),d.setRequestHeader("Authorization","Bearer "+a),d.setRequestHeader("Content-Type","application/json; charset=UTF-8");let o={};i.forEach((function(e,t){o[t]=e})),d.send(JSON.stringify(o)),d.onload=function(){let e=JSON.parse(d.response);console.log(e),!0===e.success?window.location.href="/cms":document.getElementById("formMsg").style.display="block"}}))}return{deleteArticle:function(e){!function(e){let t=localStorage.getItem("token"),n=`${window.location.origin}/api/articles/${e}`,a=new XMLHttpRequest;a.open("DELETE",n),a.setRequestHeader("Authorization","Bearer "+t),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.send(),a.onload=function(){!0===JSON.parse(a.response).success?window.location.hash="#":alert("Unknown error, the article could not be deleted")}}(e)},load:function(){let t=window.location.hash.split("-");switch(t[0]){case"#create":document.getElementById("app").innerHTML='\n          <div class="card">\n            <div class="card-header clearfix">\n              <h2 class="h3 float-left">New Post</h2>\n              <div class="float-right">\n                <a href="#" class="btn btn-primary">Cancel</a>\n              </div>\n            </div>\n            <div class="card-body">\n              <form id="createArticle" class="card-body">\n\n                <div id="formMsg" class="alert alert-danger text-center">Your form has errors</div>\n  \n                <div class="row">\n                  <div class="form-group col-md-12">\n                    <label for="title">Title</label>\n                    <input type="text" id="title" name="title" class="form-control" required>\n                  </div>\n                </div>\n  \n                <div class="text-right">\n                  <input type="submit" value="Submit" class="btn btn-lg btn-primary btn-sm-block">\n                </div>\n              </form>\n            </div>\n          </div>\n      ',e("createArticle","/api/articles","POST");break;case"#view":!function(e){let t=localStorage.getItem("token"),n=`${window.location.origin}/api/articles/${e}`,a=new XMLHttpRequest;a.open("GET",n),a.setRequestHeader("Authorization","Bearer "+t),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.send(),a.onload=function(){let e=document.getElementById("app"),t=JSON.parse(a.response),n="";n=`<div class="card">\n          <div class="card-header clearfix">\n            <h2 class="h3 float-left">${t.article.title}</h2>\n            <div class="float-right">\n              <a href="#edit-${t.article._id}" class="btn btn-primary">Edit</a>\n            </div>\n          </div>\n          <div class="card-body">\n            <div><strong>Title:</strong> <em>${t.article.title}</em></div>\n            <div><strong>Slug:</strong> <em>${t.article.slug}</em></div>\n            <div><strong>Format:</strong> <em>${t.article.format}</em></div>\n            <div><strong>Type:</strong> <em>${t.article.type}</em></div>\n            <div><strong>Description:</strong> <em>${t.article.description}</em></div>\n            <div><strong>Keywords:</strong> <em>${t.article.keywords}</em></div>\n            <div><strong>Published:</strong> <em>${t.article.published}</em></div>\n            <div><strong>Created:</strong> <em>${t.article.created}</em></div>\n            <div><strong>Modified:</strong> <em>${t.article.modified}</em></div>\n            <div><strong>Body:</strong></div>\n            <pre>${t.article.body}</pre>\n\n        </div>`,e.innerHTML=n}}(t[1]);break;case"#edit":!function(t){let n=localStorage.getItem("token"),a=`${window.location.origin}/api/articles/${t}`,r=new XMLHttpRequest;r.open("GET",a),r.setRequestHeader("Authorization","Bearer "+n),r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.send(),r.onload=function(){let t=document.getElementById("app"),n=JSON.parse(r.response);var a=new Date(n.article.created),i=`\n          <div class="card">\n            <div class="card-header clearfix">\n              <h2 class="h3 float-left">Edit Post</h2>\n              <div class="float-right">\n                <a href="#" class="btn btn-primary">Cancel</a>\n              </div>\n            </div>\n            <div class="card-body">\n              <form id="editArticle" class="card-body">\n                <div id="formMsg" class="alert alert-danger text-center">Your form has errors</div>\n  \n                <div class="row">\n                  <div class="form-group col-md-12">\n                    <label for="title">Title</label>\n                    <input type="text" id="title" name="title" class="form-control" value="${n.article.title}" required>\n                  </div>\n                </div>\n\n                <div class="row">\n                  <div class="form-group col-md-12">\n                    <label for="title">Slug</label>\n                    <input type="text" id="slug" name="slug" class="form-control" value="${n.article.slug}" required>\n                  </div>\n                </div>\n\n                <div class="row">\n                  <div class="form-group col-md-6">\n                    <label for="created">Created On</label>\n                    <input type="datetime-local" id="created" name="created" class="form-control" value="${n.article.created}" required>\n                    <small class="form-text text-muted">created raw: ${n.article.created} <br> created localized: ${a}</small>\n                  </div>\n                  <div class="form-group col-md-6">\n                    <label for="published">Published On</label>\n                    <input type="datetime-local" id="published" name="published" class="form-control" value="${n.article.published}" required>\n                    <small class="form-text text-muted">created raw: ${n.article.created} <br> created localized: ${a}</small>\n                  </div>\n                </div>\n\n                <div class="row">\n                  <div class="form-group col-md-6">\n                    <label for="format">Format</label>\n                    <input type="text" id="format" name="format" class="form-control" value="${n.article.format}" required>\n                    <small class="form-text text-muted">[md]</small>\n                  </div>\n                  <div class="form-group col-md-6">\n                    <label for="published">Type</label>\n                    <input type="test" id="type" name="type" class="form-control" value="${n.article.type}" required>\n                    <small class="form-text text-muted">[game, post, page, special, tool]</small>\n                  </div>\n                </div>\n\n                <div class="row">\n                  <div class="form-group col-md">\n                    <label for="body">Body</label>\n                    <textarea id="body" name="body" class="form-control" rows="6" required>${n.article.body}</textarea>\n                  </div>\n                </div>\n  \n                <div class="row">\n                  <div class="form-group col-md-6">\n                    <label for="description">Summary</label>\n                    <input type="text" id="description" name="description" class="form-control" value="${n.article.description}" required>\n                  </div>\n  \n                  <div class="form-group col-md-6">\n                    <label for="keywords">Keywords (separated by commas)</label>\n                    <input type="text" id="keywords" name="keywords" class="form-control" value="${n.article.keywords}" required>\n                  </div>\n                </div>\n                <div>\n                  <input type="hidden" id="_id" name="_id" class="form-control" value="${n.article._id}" required>\n                </div>\n                <div>\n                  <input type="hidden" id="created" name="created" class="form-control" value="${n.article.created}" required>\n                </div>\n  \n                <div class="text-right">\n                  <input type="submit" value="Submit" class="btn btn-lg btn-primary btn-sm-block">\n                </div>\n              </form>\n            </div>\n            <div>\n              <a href="#delete-${n.article._id}" class="text-danger">Delete</a>\n            </div>\n          </div>`;t.innerHTML=i,e("editArticle","/api/articles","PUT")}}(t[1]);break;case"#delete":!function(e){let t=localStorage.getItem("token"),n=`${window.location.origin}/api/articles/${e}`,a=new XMLHttpRequest;a.open("GET",n),a.setRequestHeader("Authorization","Bearer "+t),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.send(),a.onload=function(){let e=document.getElementById("app"),t=JSON.parse(a.response),n="";n=`<div class="card bg-transparent border-danger text-danger bg-danger">\n          <div class="card-header bg-transparent border-danger">\n            <h2 class="h3 text-center">You're deleting this article</h2>\n          </div>\n          <div class="card-body text-center">\n            <div>\n              Are you sure you want to delete\n              <strong>${t.article.title}</strong>\n            </div>\n\n            <div>Summary: <strong>${t.article.description}</strong></div>\n\n            <div class="text-center">\n              <br>\n              <a onclick="articlesApp.deleteArticle('${t.article._id}');" class="btn btn-lg btn-danger text-white">\n                Yes delete ${t.article.description}\n              </a>\n            </div>\n\n          </div>\n        </div>`,e.innerHTML=n}}(t[1]);break;default:!function(){let e=localStorage.getItem("token"),t=window.location.origin+"/api/articles",n=new XMLHttpRequest;n.open("GET",t),n.setRequestHeader("Authorization","Bearer "+e),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.send(),n.onload=function(){let e=document.getElementById("app"),t=JSON.parse(n.response).articles,a="",r="";for(let e=0;e<t.length;e++)r=r+`<tr>\n            <td>\n              <a href="#view-${t[e]._id}">${t[e].title}</a>\n            </td>\n            <td>${t[e].description}</td>\n            <td>${t[e].type}</td>\n            <td>`+(t[e].published?""+t[e].published.slice(0,19).replace("T"," "):"No Publication Date Set")+"\n            </td>\n          </tr>";a=`<div class="card">\n          <div class="card-header clearfix">\n            <h2 class="h3 float-left">Posts</h2>\n            <div class="float-right">\n              <a href="/cms/#create" class="btn btn-primary">New Post</a>\n            </div>\n          </div>\n          <div class="table-responsive">\n            <table class="table table-striped table-hover table-bordered">\n              <thead>\n                <tr>\n                  <th>Title</th>\n                  <th>Description</th>\n                  <th>Type</th>\n                  <th>Date Published</th>\n                </tr>\n              </thead>\n              <tbody>${r}</tbody>\n            </table>\n          </div>\n        </div>`,e.innerHTML=a}}()}}}}();articlesApp.load(),window.addEventListener("hashchange",(function(){articlesApp.load()}));